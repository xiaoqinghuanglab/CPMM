library("devtools")
library('usethis')
library("devtools")
install_github("aifimmunology/PALMO")
library("PALMO")
load("E:/MS/Thesis/Data_Prpcessing/.Rhistory")
install.packages("qqman")
getwd()
library(qqman)
results <- read.table("gwas_results.assoc.txt", header=TRUE)
manhattan(results, chr="Chr", bp="Pos", p="p_wald", snp="SNP", main="GWAS Results")
View(results)
manhattan(results, chr="chr", bp="ps", p="p_wald", snp="SNP", main="GWAS Results")
manhattan(results, chr="chr", bp="ps", p="p_wald", main="GWAS Results")
manhattan(results, chr="chr", bp="ps", p="p_wald", main="GWAS Results")
manhattan(results, chr="chr", bp="ps", p="p_wald", main="GWAS Results")
manhattan(results, chr="chr", bp="ps", p="p_wald", main="GWAS Results"
manhattan(results, chr="chr", bp="ps", p="p_wald", main="GWAS Results")
manhattan(results, chr="chr", bp="ps", p="p_wald", main="GWAS Results")
setwd("E:/MS/Longitudinal_Updated/CPLMM")
devtools::document()
devtools::install()
devtools::install()
library(cpmm)
library(CPMM)
df_status_change <- read.csv("./data/df_status_change_toy.csv")
df_normal_only <- read.csv("./data/df_normal_only_toy.csv")
df_abnormal_only <- read.csv("./data/df_abnormal_only_toy.csv")
df_all <- read.csv("./data/df_all_toy.csv")
df_pathways <- read.csv("./data/toy_pathways.csv")
p <- plot_cplmm(
df_status_change = df_status_change,
df_normal        = df_normal_only,
df_abnormal      = df_abnormal_only,
protein          = "P1",
covariates       = c("SEX","BASELINE_AGE"),    # adjust if your covariates differ
subject_id_col   = "SUBID",
years_since_onset_col = "years_since_onset",
export           = FALSE
)
p <- plot_cpmm(
df_status_change = df_status_change,
df_normal        = df_normal_only,
df_abnormal      = df_abnormal_only,
protein          = "P1",
covariates       = c("SEX","BASELINE_AGE"),    # adjust if your covariates differ
subject_id_col   = "SUBID",
years_since_onset_col = "years_since_onset",
export           = FALSE
)
p
proteins <- colnames(df_normal_only)[9:27]
results <- fit_cplmm_all_proteins(
df_status_change = df_status_change,
df_normal = df_normal_only,
df_abnormal = df_abnormal_only,
protein_list = proteins,
covariates = c("SEX", "BASELINE_AGE"),
subject_id_col = "SUBID",
years_since_onset_col = "years_since_onset"
)
results <- fit_cpmm_all_proteins(
df_status_change = df_status_change,
df_normal = df_normal_only,
df_abnormal = df_abnormal_only,
protein_list = proteins,
covariates = c("SEX", "BASELINE_AGE"),
subject_id_col = "SUBID",
years_since_onset_col = "years_since_onset"
)
wald <- compute_wald_test(
results_df = results,
adjust_p = TRUE,
rank_by = 1,                   # 1 to rank by Beta 1 and Beta 3; 2 to rank by Beta 2 and Beta 4
alpha = 0.05                   # User defined threshold
)
plot_wald_volcano(
wald_df = wald,
pval_col = "P-value 1",
fdr_col = "Adjusted P-value 1",
annotate = TRUE
)
plot_quadrant_beta(
wald_df = wald,
beta_x_col = "Beta 1",
beta_y_col = "Beta 3",
fdr_col = "Adjusted P-value 1",
annotate = TRUE
)
plot_pathway_bubble(
df = df_pathways,
pathway_col = "Cleaned_Pathway",
category_col = "Category",
source_col = "Source",
logq_col = "LogQValue",
gene_col = "Gene",
title = "Pathway Enrichment by Source",
size_scale = 15  # maximum bubble size
)
plot_pathway_gene_heatmap(
df = df_pathways,
pathway_col = "Cleaned_Pathway",
category_col = "Category",
gene_col = "Gene",
title = "Pathwayâ€“Gene Membership Heatmap"
)
plot_top_pathways_bar(
df = df_pathways,
pathway_col = "Cleaned_Pathway",
gene_col = "Gene",
logq_col = "LogQValue",         # logq (or logp) column
category_col = "Category",
top_n = 6,                      # number of pathways in the plot
annotate = TRUE                 # annotate with logq (or logp) values if available
)
plot_km_with_threshold(
biomarker_name = "P1",    # protein of choice
threshold = 3,           # user defined threshold value
wd_df = df_status_change,           # Status change data
normal_df = df_normal_only,    # Normal only data
abnm_df = df_abnormal_only,       # Abnormal only data
time_points = seq(-6, 6, by = 2)  # user defined timepoints for x-axis for better visualization
)
expr_df <- prepare_combined_expression(
df_normal_only = df_normal_only,
df_status_change = df_status_change,
df_abnormal_only = df_abnormal_only,
df_all = df_all,
subset_genes = proteins,
category_col = "CATEGORY",
categories = c("Normal","MCI","AD Dementia"),
normal_label = "Normal_only",
status_label = "Status_change",
abnormal_label = "Abnormal_only"
)
plot_expression_boxplot(
expr_df,
gene_order = proteins,  # genes/proteins of interest
hue_col = "Source",
expression_col = "Expression",
gene_col = "Gene"
)
plot_km_with_threshold(
biomarker_name = "P1",    # protein of choice
threshold = 3,           # user defined threshold value
wd_df = df_status_change,           # Status change data
normal_df = df_normal_only,    # Normal only data
abnm_df = df_abnormal_only,       # Abnormal only data
time_points = seq(-6, 6, by = 2)  # user defined timepoints for x-axis for better visualization
)
devtools::test()
install.packages(c("ragg", "svglite", "Cairo"))
# Use ragg as default graphics device
options(device = function(...) ragg::agg_png(...))
options(bitmapType = "cairo")
capabilities("png")    # should be TRUE
plot(1:10)
plot_km_with_threshold(
biomarker_name = "P1",    # protein of choice
threshold = 3,           # user defined threshold value
wd_df = df_status_change,           # Status change data
normal_df = df_normal_only,    # Normal only data
abnm_df = df_abnormal_only,       # Abnormal only data
time_points = seq(-6, 6, by = 2)  # user defined timepoints for x-axis for better visualization
)
# Use ragg as default graphics device
options(device = function(...) ragg::agg_png(...))
plot_km_with_threshold(
biomarker_name = "P1",    # protein of choice
threshold = 3,           # user defined threshold value
wd_df = df_status_change,           # Status change data
normal_df = df_normal_only,    # Normal only data
abnm_df = df_abnormal_only,       # Abnormal only data
time_points = seq(-6, 6, by = 2)  # user defined timepoints for x-axis for better visualization
)
