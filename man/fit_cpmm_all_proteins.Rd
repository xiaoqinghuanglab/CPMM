% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/models_cpmm.R
\name{fit_cpmm_all_proteins}
\alias{fit_cpmm_all_proteins}
\title{Fit change-point mixed models (CPMM) across proteins}
\usage{
fit_cpmm_all_proteins(
  df_status_change,
  protein_list,
  covariates = c("SEX", "BASELINE_AGE"),
  subject_id_col = "SUBID",
  years_since_onset_col = "years_since_onset"
)
}
\arguments{
\item{df_status_change}{Data frame for status-change subjects only.}

\item{protein_list}{Character vector of protein column names.}

\item{covariates}{Fixed-effect covariates. Default c("SEX","BASELINE_AGE").}

\item{subject_id_col}{Subject ID column. Default "SUBID".}

\item{years_since_onset_col}{Years-since-onset column. Default "years_since_onset".}
}
\value{
A tibble with one row per protein containing Beta 1â€“2, SEs,
intercept, and model fit metrics.
}
\description{
Fits a random-intercept CPMM per protein
}
\details{
protein ~ before_onset + after_onset + covariates + (1 | subject_id)

The change point is fixed at 0 on \code{years_since_onset_col}.
Piecewise terms are defined as:
\itemize{
\item before_onset = pmax(0, -years_since_onset)
\item after_onset  = pmax(0,  years_since_onset)
}
}
